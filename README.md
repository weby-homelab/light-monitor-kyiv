# light-monitor-kyiv (Extended Fork)

[![Check Outages](https://img.shields.io/github/actions/workflow/status/weby-homelab/light-monitor-kyiv/check_outages.yml?label=Check%20Outages&style=flat-square)](https://github.com/weby-homelab/light-monitor-kyiv/actions/workflows/check_outages.yml)
[![Python](https://img.shields.io/badge/python-3.10%2B-blue?style=flat-square)](https://www.python.org/)
[![License](https://img.shields.io/github/license/weby-homelab/light-monitor-kyiv?style=flat-square)](LICENSE)

–¶–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è (—Ñ–æ—Ä–∫) –ø—Ä–æ–µ–∫—Ç—É [banditByte/light-monitor-kyiv](https://github.com/banditByte/light-monitor-kyiv).
–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ –≤—ñ–¥–∫–ª—é—á–µ–Ω—å. –¶–µ–π —Ñ–æ—Ä–∫ –¥–æ–¥–∞—î **–º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É —Å–≤—ñ—Ç–ª–∞**, –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è "–û—á—ñ–∫—É–≤–∞–Ω–Ω—è/–†–µ–∞–ª—å–Ω—ñ—Å—Ç—å" —Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é –¥–µ—Ç–∞–ª—å–Ω–∏—Ö –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –∑–≤—ñ—Ç—ñ–≤.

## üåü –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

1.  **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ (Original):** –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ [outage-data-ua](https://github.com/Baskerville42/outage-data-ua) —Ç–∞ YASNO.
2.  **–†–µ–∞–ª—å–Ω–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ (New):** –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ñ–∞–∫—Ç–∏—á–Ω–æ—ó –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó (—á–µ—Ä–µ–∑ –ø—ñ–Ω–≥–∏ –∞–±–æ –ª–æ–∫–∞–ª—å–Ω–∏–π –∑–∞–ø—É—Å–∫).
3.  **–ì—Ä–∞—Ñ—ñ—á–Ω—ñ –∑–≤—ñ—Ç–∏ (New):**
    *   **–©–æ–¥–µ–Ω–Ω–∏–π –∑–≤—ñ—Ç:** –ì—Ä–∞—Ñ—ñ–∫, —â–æ –Ω–∞–∫–ª–∞–¥–∞—î —Ñ–∞–∫—Ç–∏—á–Ω—ñ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –Ω–∞ –ø–ª–∞–Ω–æ–≤—ñ. –î–æ–∑–≤–æ–ª—è—î –ø–æ–±–∞—á–∏—Ç–∏, –Ω–∞—Å–∫—ñ–ª—å–∫–∏ —Ç–æ—á–Ω–æ –¥–æ—Ç—Ä–∏–º—É—é—Ç—å—Å—è –≥—Ä–∞—Ñ—ñ–∫—ñ–≤.
    *   **–¢–∏–∂–Ω–µ–≤–∏–π –∑–≤—ñ—Ç:** –ó–≤–µ–¥–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 7 –¥–Ω—ñ–≤ (–∫—ñ–ª—å–∫—ñ—Å—Ç—å –≥–æ–¥–∏–Ω –∑—ñ —Å–≤—ñ—Ç–ª–æ–º/–±–µ–∑).
4.  **Telegram-–±–æ—Ç:**
    *   –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –∑–º—ñ–Ω—É –≥—Ä–∞—Ñ—ñ–∫—ñ–≤.
    *   –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ —Ñ–∞–∫—Ç–∏—á–Ω–µ –∑–Ω–∏–∫–Ω–µ–Ω–Ω—è/–ø–æ—è–≤—É —Å–≤—ñ—Ç–ª–∞.
    *   –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –∑–≤—ñ—Ç—ñ–≤.

## üìä –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–≤—ñ—Ç—ñ–≤

–°–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä—É—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –¥–µ:
*   üü¢ **–ó–µ–ª–µ–Ω–∏–π:** –°–≤—ñ—Ç–ª–æ –±—É–ª–æ (—Ñ–∞–∫—Ç–∏—á–Ω–æ).
*   üî¥ **–ß–µ—Ä–≤–æ–Ω–∏–π:** –°–≤—ñ—Ç–ª–∞ –Ω–µ –±—É–ª–æ (—Ñ–∞–∫—Ç–∏—á–Ω–æ).
*   ‚¨ú **–°—ñ—Ä–∏–π —Ñ–æ–Ω:** –ü–ª–∞–Ω–æ–≤—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ (—Å—ñ—Ä—ñ —Å–º—É–≥–∏ –ø–æ–∫–∞–∑—É—é—Ç—å, –∫–æ–ª–∏ —Å–≤—ñ—Ç–ª–æ *–º–∞–ª–æ –±* –±—É—Ç–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ–º –∑–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º).

–¶–µ –¥–æ–∑–≤–æ–ª—è—î –º–∏—Ç—Ç—î–≤–æ –æ—Ü—ñ–Ω–∏—Ç–∏ —Å–∏—Ç—É–∞—Ü—ñ—é: "–ß–∏ –≤–∏–º–∏–∫–∞–ª–∏ —Å–≤—ñ—Ç–ª–æ —Ç–æ–¥—ñ, –∫–æ–ª–∏ –Ω–µ –º–∞–ª–∏ –±?"

## üõ† –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞–π–∫—Ä–∞—â–µ –ø—Ä–∞—Ü—é—î –Ω–∞ –ø—Ä–∏—Å—Ç—Ä–æ—ó, —è–∫–∏–π –ø—Ä–∞—Ü—é—î 24/7 (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, VPS —Å–µ—Ä–≤–µ—Ä, Raspberry Pi –∞–±–æ —Å—Ç–∞—Ä–∏–π –Ω–æ—É—Ç–±—É–∫).

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é

```bash
git clone https://github.com/weby-homelab/light-monitor-kyiv.git
cd light-monitor-kyiv
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è Python 3.10+. –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–µ —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ.

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 3. –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

–°–∫–æ–ø—ñ—é–π—Ç–µ –ø—Ä–∏–∫–ª–∞–¥ —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞–ø—É—Å–∫—É —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–π—Ç–µ –∑–º—ñ–Ω–Ω—ñ:

```bash
cp run_light_monitor.example.sh run_light_monitor.sh
chmod +x run_light_monitor.sh
nano run_light_monitor.sh
```

–í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∫–∞–∑–∞—Ç–∏:
*   `TELEGRAM_BOT_TOKEN`: –¢–æ–∫–µ–Ω –≤–∞—à–æ–≥–æ –±–æ—Ç–∞ (–≤—ñ–¥ @BotFather).
*   `TELEGRAM_CHANNEL_ID`: ID –∫–∞–Ω–∞–ª—É –∞–±–æ —á–∞—Ç—É, –∫—É–¥–∏ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –∑–≤—ñ—Ç–∏.

–¢–∞–∫–æ–∂ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ `config.json` –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∞—à–æ—ó –≥—Ä—É–ø–∏ –≤—ñ–¥–∫–ª—é—á–µ–Ω—å (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –ö–∏—ó–≤, –≥—Ä—É–ø–∞ 4.1 / GPV36.1).

### 4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å–∏—Å—Ç–µ–º–∏

–£ –ø—Ä–æ–µ–∫—Ç—ñ —î –∫—ñ–ª—å–∫–∞ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö —Å–∫—Ä–∏–ø—Ç—ñ–≤, —è–∫—ñ –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —á–µ—Ä–µ–∑ Cron:

#### –ê. –ú–æ–Ω—ñ—Ç–æ—Ä –≥—Ä–∞—Ñ—ñ–∫—ñ–≤ (`main.py`)
–ü–µ—Ä–µ–≤—ñ—Ä—è—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–∞ Github/Yasno —ñ –Ω–∞–¥—Å–∏–ª–∞—î —Ç–µ–∫—Å—Ç–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.
*–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –∑–∞–ø—É—Å–∫:* –©–æ–¥–∏–Ω–∏.
```cron
0 * * * * /path/to/light-monitor-kyiv/run_light_monitor.sh
```

#### –ë. –°–µ—Ä–≤–µ—Ä –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É (`power_monitor_server.py`)
(–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) –ó–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è —è–∫ —Å–µ—Ä–≤—ñ—Å. –°–ª—É—Ö–∞—î –∑–∞–ø–∏—Ç–∏ –∞–±–æ –ø—ñ–Ω–≥—É—î —Ä–æ—É—Ç–µ—Ä –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Å–≤—ñ—Ç–ª–∞. –õ–æ–≥—É—î –ø–æ–¥—ñ—ó —É `event_log.json`.

#### –í. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–≤—ñ—Ç—ñ–≤
–ê–Ω–∞–ª—ñ–∑—É—î `event_log.json` (—Ñ–∞–∫—Ç–∏—á–Ω—ñ –ø–æ–¥—ñ—ó) —Ç–∞ `last_schedules.json` (—ñ—Å—Ç–æ—Ä—ñ—é –≥—Ä–∞—Ñ—ñ–∫—ñ–≤).

*   **–©–æ–¥–µ–Ω–Ω–∏–π –∑–≤—ñ—Ç (`run_daily_report.sh`):**
    –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–∞–ø—É—Å–∫–∞—Ç–∏ –≤ –∫—ñ–Ω—Ü—ñ –¥–æ–±–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 23:55).
    ```cron
    55 23 * * * /path/to/light-monitor-kyiv/run_daily_report.sh
    ```

*   **–¢–∏–∂–Ω–µ–≤–∏–π –∑–≤—ñ—Ç (`run_weekly_report.sh`):**
    –†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–∞–ø—É—Å–∫–∞—Ç–∏ –≤ –Ω–µ–¥—ñ–ª—é –≤–≤–µ—á–µ—Ä—ñ.
    ```cron
    58 23 * * 0 /path/to/light-monitor-kyiv/run_weekly_report.sh
    ```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

*   `main.py`: –û—Å–Ω–æ–≤–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥—Ä–∞—Ñ—ñ–∫—ñ–≤.
*   `power_monitor_server.py`: –õ–æ–≥—ñ–∫–∞ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É (Up/Down).
*   `generate_daily_report.py`: –ú–∞–ª—é–≤–∞–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—É –∑–∞ –¥–æ–±—É.
*   `generate_weekly_report.py`: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞ —Ç–∏–∂–¥–µ–Ω—å.
*   `event_log.json`: –ñ—É—Ä–Ω–∞–ª —Ä–µ–∞–ª—å–Ω–∏—Ö –≤—ñ–¥–∫–ª—é—á–µ–Ω—å (–±–∞–∑–∞ –¥–∞–Ω–∏—Ö –¥–ª—è –∑–≤—ñ—Ç—ñ–≤).
*   `last_schedules.json`: –ö–µ—à –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –≤—ñ–¥–æ–º–∏—Ö –≥—Ä–∞—Ñ—ñ–∫—ñ–≤.

## ü§ù –ü–æ–¥—è–∫–∞

*   [banditByte](https://github.com/banditByte) –∑–∞ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—É —ñ–¥–µ—é —Ç–∞ –ø–∞—Ä—Å–µ—Ä –≥—Ä–∞—Ñ—ñ–∫—ñ–≤.
*   [outage-data-ua](https://github.com/Baskerville42/outage-data-ua) –∑–∞ –¥–∂–µ—Ä–µ–ª–æ –¥–∞–Ω–∏—Ö.

---
**License:** MIT
